<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>AM Usin'ss</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#121212">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" href="/icon-192.jpg" sizes="192x192" type="image/jpeg">
  <link rel="icon" href="/icon-512.jpg" sizes="512x512" type="image/jpeg">
  <link rel="apple-touch-icon" href="/apple-touch-icon-180.jpg">

  <style>
    /* ================= BASE ================= */
    * { box-sizing: border-box; --day-padding: 6px; }
    html { box-sizing: border-box; }
    body{
      margin:0;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom) 0;
      font-family:'Poppins',sans-serif;
      background:#121212;
      color:#eee;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling:touch;
    }

    canvas#particles{ position:fixed; inset:0; width:100%; height:100%; pointer-events:none; z-index:0; display:block; }

    .logo-container{ display:flex; justify-content:center; align-items:center; padding:28px 12px 20px; z-index:1; }
    .logo{ width:200px; max-width:70vw; height:auto; filter:brightness(0) invert(1); display:block; }

    @keyframes glitch-crt {
      0%{transform:translate(0,0)}25%{transform:translate(-2px,2px) skew(.5deg)}50%{transform:translate(2px,-2px) skew(-.5deg)}75%{transform:translate(-1px,-1px)}100%{transform:translate(0,0)}
    }
    .logo.glitch{ filter:brightness(0) invert(1) drop-shadow(-3px 0 magenta) drop-shadow(3px 0 cyan) contrast(2.2); animation:glitch-crt .15s steps(1) infinite; }

    /* ================= KRA CARD ================= */
    .kra-outer{ --outer-radius:12px; width:min(92%,900px); max-width:900px; margin:0 auto; position:relative; z-index:2; }
    .kra-container{
      --bg:#1b1b1f;
      border-radius:12px;
      padding:12px 16px;
      background-image:
        linear-gradient(var(--bg),var(--bg)),
        linear-gradient(90deg,var(--bg) 0%,var(--bg) 42%,#ff4aad 48%,#c86bff 50%,#8e2be2 52%,var(--bg) 58%,var(--bg) 100%);
      background-origin:padding-box,border-box;
      background-clip:padding-box,border-box;
      background-size:100% 100%,300% 100%;
      animation:kra-border-slide 6.8s linear infinite;
      border:2px solid transparent;
      display:flex;
      flex-direction:column;
      align-items:stretch;
      gap:8px;
      color:#eee;
      position:relative;
      overflow:visible;
      isolation:isolate;
    }
    .kra-container::before{
      content:"";
      position:absolute;
      inset:-22px;
      border-radius:calc(12px + 22px);
      background:radial-gradient(50% 60% at 50% 45%, rgba(200,90,240,0.46) 0%, rgba(200,90,240,0.30) 18%,rgba(200,90,240,0.14) 36%, rgba(140,60,220,0.06) 56%, transparent 78%);
      filter:blur(20px);
      z-index:0;
      pointer-events:none;
      transform-origin:center center;
      animation:kra-glow-breathe 3s cubic-bezier(.4,0,.2,1) infinite alternate;
      opacity:0.92;
      backface-visibility:hidden;
    }

    @keyframes kra-border-slide{ 0%{background-position:0% 50%,0% 50%}50%{background-position:0% 50%,100% 50%}100%{background-position:0% 50%,0% 50%} }
    @keyframes kra-glow-breathe{ from{transform:scale(1);filter:blur(16px);opacity:.75}60%{transform:scale(1.045);filter:blur(28px);opacity:.93}to{transform:scale(1.09);filter:blur(40px);opacity:1} }

    .kra-container > * { position:relative; z-index:3; }

    /* header: titre centré (bouton éditer retiré) */
    .kra-header{ display:flex; align-items:center; justify-content:center; width:100%; position:relative; }
    .kra-title{ font-weight:900; font-size:1.25rem; color:#fff; text-transform:uppercase; letter-spacing:.8px; text-shadow:0 2px 6px rgba(255,255,255,.96), 0 0 18px rgba(255,255,255,.86); margin:0; padding:8px 40px; text-align:center; }

    #kra-msg{ min-height:56px; padding:12px; border-radius:10px; background:rgba(0,0,0,0.28); color:#fff; font-size:1rem; line-height:1.35; text-align:center; }
    #kra-meta{ font-size:.82rem; color:#aaa; display:flex; justify-content:space-between; gap:10px; align-items:center; padding:0 6px; flex-wrap:wrap; }

    /* ================= CONTROLS + CALENDAR ================= */
    .controls{ width:100%; max-width:1400px; margin:12px auto 0; padding: 6px 12px 8px; box-sizing:border-box; display:flex; flex-direction:column; align-items:center; gap:12px; }

    .title-row h2{ margin:0; font-size:2rem; color:#fff; text-shadow:1px 1px 10px rgba(0,0,0,.7); text-align:center; }

    .calendar-controls{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      flex-wrap:wrap;
      width:100%;
      max-width:720px;
      margin-top:6px;
    }

    .calendar-controls .month-selector,
    .calendar-controls .days-selector{
      display:flex;
      align-items:center;
      gap:8px;
      background:transparent;
    }

    .select-wrap{ min-width:140px; }
    select, #month-select, #cols-select{ font-size:1em; padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.06); background-color:#000; color:#fff; -webkit-appearance:none; -moz-appearance:none; appearance:none; text-align:center; min-width:120px; }

    .calendar-wrap{ width:100%; max-width:1400px; padding:18px 12px 40px; box-sizing:border-box; margin:0 auto; }
    .calendar-container{ width:100%; display:block; }

    .week{ display:grid; --cols:3; grid-template-columns: repeat(var(--cols), minmax(0,1fr)); grid-template-rows:auto auto; gap:8px; margin-bottom:22px; align-items:start; width:100%; }
    .header{ background-color: rgba(31,31,31,0.30); color:#fff; font-weight:900; padding:10px 6px; font-size:1.02em; text-align:center; border-radius:10px; text-transform:uppercase; letter-spacing:.6px; min-height:44px; display:flex; align-items:center; justify-content:center; }
    .day{ background-color: rgba(44,44,44,0.18); min-height:110px; border-radius:15px; display:flex; flex-direction:column; justify-content:flex-start; align-items:flex-start; position:relative; cursor:pointer; padding:var(--day-padding); overflow:hidden; transition: transform .28s, box-shadow .28s; box-sizing:border-box; }
    .day:hover{ transform: translateY(-3px); box-shadow:0 14px 34px rgba(0,0,0,0.65); }

    .event{ position:relative; left:calc(var(--day-padding) * -1); width:calc(100% + (var(--day-padding) * 2)); border-radius:12px; color:#fff; font-weight:700; font-size:.95em; margin-bottom:8px; padding:10px 14px; display:flex; flex-direction:column; box-sizing:border-box; overflow-wrap:break-word; border:1px solid rgba(0,0,0,0.12); }
    .event .time{ font-size:.78em; color: rgba(255,255,255,0.98); margin-bottom:6px; font-weight:800; text-shadow: 0 1px 6px rgba(0,0,0,0.35); }
    .event .title{ font-weight:900; font-size:1.02em; }
    .event .description{ font-weight:400; font-size:.85em; color:#eee; margin-top:6px; }

    .event.blue{ background: linear-gradient(135deg,#00baff 0%,#0066ff 100%); box-shadow:0 8px 28px rgba(0,102,255,0.28); }
    .event.red{ background: linear-gradient(135deg,#ff3a7a 0%,#ff6a2a 100%); box-shadow:0 8px 28px rgba(255,60,120,0.26); }
    .event.pink{ background: linear-gradient(135deg,#ff7bdc 0%,#ff4aa8 100%); box-shadow:0 8px 28px rgba(255,80,160,0.24); }
    .event.yellow{ background: linear-gradient(135deg,#ffd400 0%,#ffb200 100%); color:#111; box-shadow:0 8px 28px rgba(255,180,40,0.20); }
    .event.grey{ background: linear-gradient(135deg,#9fa9b8 0%,#6e7076 100%); color:#111; box-shadow:0 8px 28px rgba(80,90,100,0.14); }
    .event.orange{ background: linear-gradient(135deg,#ff9944 0%,#ff7a00 100%); color:#111; box-shadow:0 8px 28px rgba(255,120,50,0.18); }
    .event.green{ background: linear-gradient(135deg,#2bd07b 0%,#0fa55d 100%); color:#05220e; box-shadow:0 8px 28px rgba(20,160,90,0.18); }
    .event.text-black{ color:#000 !important; }

    /* zoom modal */
    .zoom-outer{ position:fixed; z-index:3000; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:auto; }
    .zoom-inner{ position:absolute; transform-origin:center center; transition: transform 380ms cubic-bezier(.22,.9,.32,1), left .42s, top .42s, width .42s, height .42s; will-change:transform; border-radius:14px; overflow:hidden; background:transparent; box-shadow:0 30px 80px rgba(0,0,0,0.6); }
    .zoom-fixed-close{ position:fixed; top:14px; right:14px; z-index:3201; background:#ff004f; color:#fff; border:none; padding:10px 14px; border-radius:9px; cursor:pointer; font-weight:700; box-shadow:0 6px 22px rgba(0,0,0,.45); }

    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.7); z-index:2999; display:none; }

    .footer{ margin: 18px 0 40px; color: rgba(255,255,255,0.12); font-size:.85rem; text-align:center; }

    @media (max-width:920px){
      .logo{ width:160px; }
      .title-row h2{ font-size:1.6rem; }
      .controls{ margin:10px auto 0; padding:6px 12px 8px; }
      .calendar-controls{ max-width:640px; gap:10px; }
      .select-wrap{ min-width:120px; }
      .week{ gap:10px; }
      .day{ min-height:120px; }
    }
    @media (max-width:420px){
      .week{ --cols:2; grid-template-columns: repeat(var(--cols), minmax(0,1fr)); }
      .logo{ max-width:60vw; }
      .select-wrap{ min-width:100px; }
    }

    /* freeze page while modal open: handled via JS (we set top and add class) */
    .modal-open{ position:fixed; left:0; right:0; overflow:hidden; }
  </style>
</head>

<script>
/*
  Auto-reload after deploy
  - vérifie périodiquement l'ETag ou Last-Modified de la page racine (ou /manifest.json)
  - si changement détecté -> reload.
  - fallback : on récupère le HTML et on calcule un petit hash si le serveur ne renvoie pas d'headers.
*/

(function(){
  const CHECK_URL = '/index.html'; // ou '/manifest.json' si tu préfères
  const INTERVAL_MS = 1 * 1000;   // fréquence de vérif (15s). Augmente si tu veux moins de requêtes.
  let knownTag = null;
  let knownLM = null;
  let knownHash = null;

  // simple hash pour fallback (pas crypto, juste pour détecter changement)
  function simpleHash(s){
    let h = 2166136261 >>> 0;
    for(let i=0;i<s.length;i++){
      h ^= s.charCodeAt(i);
      h = Math.imul(h, 16777619) >>> 0;
    }
    return h.toString(36);
  }

  async function checkOnce(){
    try{
      // on essaie d'abord HEAD pour être light. Si HEAD renvoie pas les headers, on GET.
      let res = await fetch(CHECK_URL, { method: 'HEAD', cache: 'no-store' });
      if(!res.ok){
        // fallback GET
        res = await fetch(CHECK_URL, { method: 'GET', cache: 'no-store' });
      }

      // headers à surveiller
      const etag = res.headers.get('etag');
      const lm = res.headers.get('last-modified');

      if(etag){
        if(knownTag && knownTag !== etag){
          console.log('Auto-reload: ETag changed', knownTag, '→', etag);
          return reloadSafe();
        }
        knownTag = knownTag || etag;
        return;
      }

      if(lm){
        if(knownLM && knownLM !== lm){
          console.log('Auto-reload: Last-Modified changed', knownLM, '→', lm);
          return reloadSafe();
        }
        knownLM = knownLM || lm;
        return;
      }

      // fallback : on lit le body et on compare hash
      if(res.bodyUsed === false){
        const txt = await res.text();
        const h = simpleHash(txt);
        if(knownHash && knownHash !== h){
          console.log('Auto-reload: body hash changed', knownHash, '→', h);
          return reloadSafe();
        }
        knownHash = knownHash || h;
      }
    }catch(err){
      // silent fail (réseau, CDN momentané). On retente au prochain interval.
      // console.warn('checkOnce error', err);
    }
  }

  // reload sécurisé : bypass cache en ajoutant timestamp au href
  function reloadSafe(){
    // if a modal / editing state exists, you could optionally prompt user
    const url = new URL(window.location.href);
    url.searchParams.set('_r', Date.now());
    window.location.replace(url.toString());
  }

  // démarrer après chargement complet
  window.addEventListener('load', ()=>{
    // run initial check to seed knownTag/LM/hash
    checkOnce();
    setInterval(checkOnce, INTERVAL_MS);
  });
})();
</script>

<body>
  <canvas id="particles"></canvas>

  <div class="logo-container">
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVcAAADtCAYAAAALFza/AAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAACxIAAAsSAdLdfvwAABjQSURBVHhe7Z15zHRlecZRRLaQsCRshqZgNBX6ByUSKRFrm7D+UwE1tGyBEkqhaVm6CQKptdbYSBArCYJWGvkU1FKBtmy2UKE0DRQIBEWtImqjFtkFF2h7XbZjTodrZs7MnOe+n/O81y/5JV/mm5mzXOc97/vc51k2M8YYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMWZpjoD/neyx0BhjmmITVDe8SG+FxhjTDNvAp6G64UX6PNwBGmNMExwO1c0uw+OhMcY0wdVQ3egyvAkaY8zo2QrWUBKY+BzcHhpjzKg5DKqbXKYnQWOMGTXXQHWDy/RmaIwxo2UL+CRUN7hMfwjda8AYM1oOgermVoOnQWOMGSVXQXVjq8HboDHGjI6XwyegurHV4k7QGGNGRQ1zCSzydGiMMaOi5pLAxDuhMcaMhlfAZ6C6odXmLtAYY0bBkVDdyGr0VGiMMaOgprkEFunSgDFmFGwLObWfupHVqksDxpjqeRtUN7CaPQUaY0zVXAvVDaxmXRowxlTNdvBHUN3AavbH0KUBY0y1HAXVzWsMuteAMaZaboDqxjUG74Avg8YYUxUsCbwA1Y1rDHIawl2hMcZUxduhummNyTOgMcZUxT9DdcMakywNGGNMNXDgAJ+4qxvWmGRPB5cGjDHV8FaoblZj9BxojDFVwE746kY1Ru+CxhiTzjawhZJA192gMcakMsa5BBZ5NjTGmFT+Caob1Ji9GxpjTBqt9BJQ7g6NMSaFY6C6MbXgWdAYUykHQfWDW7Mnwr60MHBglvfCvowx567LZG5MFVwB1cVcszfCPrAk8CJU39GKe8A+jDHnrn0zN6YavgfVxVy728NFnADVZ1vyTNiHsebctU/mxlTBr0B1EY/B4+Ei/hWqz7bkfXARY865a5/MjamCy6G6iMfgLXAe/CtHfa5FF5UGxpxz10WZG1MFr4BPQXURj0HWUneEszgZqs+16LzSwNhz7rooc2Oq4FCoLuAxeRycBZ+kq8+06D1w1goFLeTcdV7mxlTBlVBdvGPyVqjgXzfq/a3KQRJ7QkULOXedlbkxVbA1fBqqi3dMcm7THeA0vwHV+1tWzTXQSs5dZ2VuTBUcAdWFO0aPhdPwCbp6b8uyNPBy2KWlnLuqzI2pgk1QXbRjdLqZyJJA6wMHlCwN7AW7tJRzV5cGTJVwbtOWmorPw24z8SSo3hflf4nXojwXTmgt567TmRtTBYdDdcGO2W7n8uySwDfEa1F25xpoMeeuHlBgquNqqC7WMXsTJBw4kFkS4MOWP556LVL+1TwpDbSYc9dJ5sZUwVawxabic5A31uySwOfh66Zei/YC2GrOXSeZG1MFh0F1obYgR2Txibn6vyiPhuRLUP1/hA/ClnPuyl+mxlTBNVBdpC34j/CFqdci5dN6PkQi50H1nij/VrzWojdDY9LZAj4J1UXagtlLudwBJ7wWqvdEyafp6vXW/CF0rwGTziFQXaB2GLnCbJfM0sBG8jRoTCpXQXVx2vVlOWI72CW7NLBRvA0akwaHRT4B1cVp17dbEpjALlHqvXZ4d4LGpNDqGPNafCtUfAGq99thPR0ak4JLAuVUJYEJ50P1mRbNHPZ7JzQmHM5E/wxUF6Vd39vhLDjHqvpMi35FvBbpLtCYUI6E6mK0w3gUnMcDUH2uNX9fvBbpqdCYUFofY54pSwKckHoeF0L12Zb8AeR5+FbntWhdGjChbAs3SofyDP8eLoKlgcx6ZISs6ZNLoPr/KF0aMGGwY7u6CO0w/irsw0NQfb4VJ+dhP6j+P8pToDEhXAvVRRghZ2XKnNu0tBx6uTnsg/p8KzLn7nnIzNylARMCuwdxflF1EUb4cfjBqdda8u9gXz4F1Xe0IHPukpk555dwacAUh0+x1QUYJae9y24mlpTH15dDofqOFpw+D9mZu9eAKc51UF18EXKo7csgh90++n+vtSSfjvP4+sK+xi0+WJzk3CU7cw5FXiYbY5aCJQHeANTFF+Hk6TFpsTTQp5fANJ+A6rvGbDfnLpmZsxa+KzSmCNkDBw6GE14PW+uKxOkbl+XNUH3XmO3m3CU78zOgMUW4HqqLLsLHIZvBE/jvr0P13jHKFkH3+JbhWai+c4xO59wlO3M1S5kxa8OBA9+H6qKL8JNwmvdD9d4xus7SIpug+s4xqnLukpk5e8m4NGAGJ7skoJrM+8NWSgOcvnFV3gjVd47RRaWR7MzPgcYMSmYvAXYofyWcppXSAB+WqONbhhZmKJuVc5fszO+CxgwGVx/N/OFls3cW74HqM2PyRrguLfQamJdzl+zMd4PGDALXzVcXWZTsLD+LfaH6zJhcpyQwoYXSwLycu2RnfjY0ZhAy5xJ4Ck7W7Z/FmEsD7CWw6Pj6wHH4Y+410CfnLpmZ3w2NWRv2Esj8oZ3VobzLu6H67BhcZi6BRfBJu9rGGOyTc5fszHeHxqzFMVBdXFEeDhexD1SfHYN9jq8vb4JqG2Nw2fOQnflZ0Ji1uAGqiytCNhUXzcg/4RGovqNmJzPtDwWftI+xNLBMzl0yM78XGrMyLAmwm5C6uCL8COzLGHsNfAYODZvXals1u0zOXbIz3wMasxInQHVRRTlrjLlib6i+o2aXOb6+jLE0sOp5yM78TGjMSrD/pbqoInwSLjvW/qtQfVeNrjOXwDy2hOyMr7ZZo6vk3CUz8/ugMUuzPVQXVJSXwWV5H1TfVaNcPbcUfwnVNmt0lZy7ZGfu0oBZmhOhupiiZPN2WcbUa2CV4+vLmEoD656H7MxdGjBL8zmoLqYIH4Or8mWovrMmn4MlYTN7DKWBdXLukpn5PdArFJje7AgzZx76MFyV90L1nTV5DSzNFVBtuybXyblLZuZcvHBPaEwvjofqQoryQLgqbCa+CNX31uI6x9eXA6Dadk0OdR6yM/dcA6Y3mSWB78J14EJ2X4Tqu2uQE45HUXNpYN2cu2RnztIA98GYubAkwBnX1UUUIZuz6/IuqL67Bj8No2CzW+1DDQ6Rc5fMzFka2AsaM5djobqAouTUeevCzuUvQPX92ZbsJTANF/RT+1CDQ+TcJTvzc6Exc8ksCXwHcuq8deF3PATVNjLluP8hjm8ZnoBqXzIdKucu2Zl7rgEzFw4c4MghdfFEuOoYc8U7odpGpiXmElhEjb0Ghsy5S2bm7F3j0oCZyXFQXThRDtlUfB1U28g0siQwYT+o9iXToUsCE7IzvwAa8xLYEZrLO6uLJkI+Pd4CDsmXoNpWhiwJDH18fXkcqn3KsETOXTIzfxAa8xJ2gBw5pC6aCIfqUN7lPKi2lWHEwIFZ1FQaKJFzl+zMfxYa8/84GaqLJULWqw6CQ/NaqLaXYYnj60stpYFSOXfJztylAfMSboHqYomQT485VV4JaigNcFnyUsfXB3Zwr6E0UDLnLpmZczCDMT+FJYHMFQcuhaWooTSw7OJ7Jbgcqn2LtGTOXbIzd68B81N+C6qLJMqST9F5oattRprRS2CaGgYU/DKMIDvzd0BjfsLtUF0kEbKpWGJG/gnZP2icUKTk8fWF+8Bhmmofo4y6uZIvQLUPET4MjfnJXALqAonyYliS7PXt6WtgNtk504/BKM6Hah+irCFzk0x2SYBT45WEfxmr7UZaQzMxO2ca+WCPc6yqfYjSpQGz2Z1QXRwR8sZXklq6YrGJmk1mzl0ju6Q9ANU+RFhD5iaRnaG6MKK8CJYke137rj8Hs8jOuevHYRQXQrUPUWZmbpL5TaguiijZub0kNZQEJrIGmEV2zl1ZGogaBszSQOZyRZmZm2TuguqiiPCbsCS1TdzCZmL0dIMTMnNWlpq4RXE/VPsQYWbmJpFdobogorwElqS2hQo5kTNv+NFk56z8BIwic0BBVuYmmVOhuiCiLFkS4F8L/wHVdjNlt7BosnNWsjQQ9Rfdq2Fm/96MzE0yLZcEuORHZq1tlmwmRi9kV1tJYGJUaYDn+9+g2ocIMzI3ibCpmLneUOmSAHshqO1my9Fakc3E7JznGVka+D2o9iHC6MxNMi33EuBfCd+Gars1yFpwFDX1EpiWpYEoOMdq5i+ZyMxNIlxx4A6oLoIIH4Ulm0k/D9V2a5HT4UWQnXMfD4RRZJYGojI3yewOM6cXLF0S+AuotluTEZ3Ls3PuY+RUjL8L1T5E6QEFG4DMMeZ8yMSp70rCNZrUtmvyz2BpaphLYJFcVyyKn4FqH6KMyNwk83mowo/w67Dk6Jx9oNpubf47LE1mzsv4SzCK+6DahwgjMjeJ7AZ/BFX4Ef45LMmHoNpujZZsJmbnvIybYBRnQrUPUbo00DBnQRV6hBElge9Bte0a5aQypcjMeVmfh1GTiWeXBkpmbpL5F6hCj/BrsOQPEQcOqO3W6iOwFJk5r+IhMIrM0kDJzE0ibCqqwKP8U1gS9kJQ261Z/kIYmuycV/EaGEXmgAJaInOTTPZF9QuwJDUsHb2sJcadZ+e8ij+AW8MIXgXVPkTpuQYaJLMTdenm0Fh6CUxb4rxk5ryOh8MoWv5ZMMG0/tv6A1BtdwwO+Rd9ds7r+FkYReutOBNI63WmJ6Da7hgcshY9xpLARJYGtoERtP78wQTS8hPSfaHa7lgcshdFZs5DeCiMouWeMyaI1vv2jWEugXkO1f83O+chjCwNtN7n2wTQ8qgU/vYfYy+BaYcYuZad8xCyNPBKGEHroxVNAC2Pp94fqu2OzSHmXBh7SWBi5ICClufZMIVpfSagD0O13bG5bjOxhZLAxBtgFK3PEGcK0vIclq2UBCauM89tds5D+hyMetjT+tzGpiAtz77O3/pqu2N1nRUaxjpwYJYHwwhaX5XDFKL1dYOuhGq7Y3aVtcWycy7hdTCKlteTM4XI7FBeesVL/rYf88CBWa7STBzzwIFZchpC/lUZQesrIZuB4c0ns6lYeq321koCE78JlyE755IeBqO4C6p9iHDZzE0yr4Y/hirMCEvPJfBXUG23BZdpJmbnXNLI0sCpUO1DlC4NjIjzoAoxQjaxSpYEyFNQbbsFl2kmZuZcWg4o2BxGwNKA2ocoXRoYEfdDFWKELAmU/KHgb3m13VZcppmYmXOER8IoXBowC9kTsoOyCjHC82FJPgbVdluyTzMxO+cIr4dRuNeAWciFUIUXZekVLp+GarsteRFcRHbOEbLEFLVCwc5Q7UOUfTI3yTwAVXgRsiRQklZ7CUz7HbiIzJwjPRpGcSdU+xBhn8xNImwqquCifAcsyUeh2m6LHgBnkZ1zpLfCKDLnGqDzMjfJsN6pQovyNbAkz0K13Ra9GM4iO+dIWRrYDkawI1T7EOW8zE0ybJar0CJ8GJbkDVBtt1XZTJw1gUlmzhlG9hq4Hap9iHBe5iaRvaAKLMrSJYGN0Etg2jfBabJzzvBzMIrs0oDK3CST3aGcP/Sl4G/zjVQSmHgpnKblgQOz5Ci0qNLADjBzGkKVuUmGU/ypsCL8IiwJf5ur7bYum4lbwi6ZOWf6FhjFLVDtQ4Qqc5PIa6EKKsoLYEmugmq7rctBAgfBCdk5Z/oPMIqTodqHCKczN8lkNxU5p2gp+Fv8Gai2GyWnwFOvR8ilbCZsxJLARC4muA2MgKUBroig9iPCbuYmmcym4oOwJNklAY77vnnqtUi/CycL2WXnzAUn1f9FGVUa4FyytWRuEuEMVCqgKEuXBD4F1XajfA88buq1aN8Ia8j5j6ZeizayNFBD5iaZd0IVToSsD5XsJcA17L8P1baj5PFtDzkFnvr/CD8Ca8j5VZ3XMuRT/Ki5BmrI3CTCqf0egiqcCO+FJXkzVNuNkmvLT2BfS/WeCPkEuZacvwLVe6KM7DWQnXnUfLZGsDfMXP/nXFiSv4Zqu1H+CZxwLFTviZLrkqnXI+zmzMEi6j1RRg4oyM7cpYFE3gVVKBGyY3fJkgB/a2eWBKZLHhx3zifW6r0tO53zblC9L0qWBraCEWRnfgU0CXBxOnbeV6FEeA8suQhhdi+Br8Hp48tsJmapcs687uivwSgyM2evAZPAPjCzqXg2LMmnodpulOxTOs3xUL23ZVXOfwDVe6O8DUaRnfmB0ATzXqjCiJBNRc4pWpLskoA6PjYT+X/qMy06K2eWBjJ/sfM5w7YwguzMPaAggS9DFUaEbCqyo3UpWMhX242SJYFZx7eRSgPzcuagAvWZKE+EUWRm/hg0gbAkoIKI8kxYkuyBA/N6QfCHWn2mReflfAZUn4mSS7JEkZ25pyEM5H1QhRDlHrAkmeO66bzjY+dy9ZkWnXcedoeZpQHKLCLIzvwyaIL4KlQhRHgfLElNAwdmcSNUn23JRTmzXJC9SOIJMIrMzJ+EXqEgAA4cUAFE2XpJoM+KCvyhVp9tyT45Z6/1fxeMIjvzg6EpDCcSUSc/ypIlAf52zhzPTfscH59UZ85WH2Gf87ArzO49wekBI8jO3HMNBPAIVCc/wtJzCRwC1Xaj7FMSmHADVN/RgsvknN1r4NdhFJmZPwWjJq3ZkGT3EjgLliR7LgFOqdeXY6D6jhZcJudTofqOKLkSbhTZmR8OTSHeDdVJj5JPiEuithnpMsfHZmKriyYucx5YGlDfEWXkzTU7cy53ZArBZqs66RHeDUvzLai2HSF7YCzLtVB915hdJefM0gBXiogkM3OWBqKWutlQ7AvVCY+y9FwC2cf3h3BZjobqu8bsKjlnr/W/H4wiO/NDoRmY7F4CHE9ekjEeH/+KyF48cWhXOQ87Q/VdUV4Eo8jOfBM0A8IuSpklgdL9CbOP72G4KtdB9Z1jdJ2cMwcUcNb+SDIzfxpy+SMzEPvDzP6E58CSZB/fKiWBCUdC9Z1jdJ2cfxuq74zyABhFdubssmgG4v1QneQIORM7nwiXJPP4OD5+nePjE+TsRRSHcN2cOTWf+t4oL4ZRZGf+SWgGILvJfAcsSfbxDdGV53qovntMDpHz/VB9d4QsDfBaiiIz88dh5LE2y+thZpOZU8uVJPv4hhgY0UJpYIicfweq744ycmq+7Mw918AAfBCqkxshx1KXLglkHt+6JYEJ28HsORHWcaicOc4/cxrCS2EU2Zl7QMGacGG4R6E6uRGyqVhyxYHs42MzdqjjG3OvgSFzzpy1n6WBLWEUmZk/Ac0asHO0OrFRctx4SVo6vqOg2sYYHPI8nAzVNiJkeekgGEV25mYNMpvMXJxuF1iSlo6PzcTMNe5XdejzwNJA5koSkQv6ZWdu1uAbUJ3UCCPWKGrt+MY418DQ54HlhZuh2laEXOt/CxhFduZmBbKbzKfAkrR4fG+Dals1W+I8HAfVtqLk6sFRZGbO0VqbQ7Mkl0B1QqMsXRJo8fjYufx5qLZXqyXOAxf0y3ySHjlrf3bmZgUyp9+LKAm0enxXQ7XNGi15HrJ7DUT+RZeduVkCdqxXJzHK0r0EWj6+MQ0oKHkejoVqm1FGlgayM2evBdMTjpNWJzHK0iWBlo+PwxLHMg1hyfPAuQYyn6RfAaPIzpwP1UxP2KxRJzHCiJJA68fH0TNq2zUZcR4ySwPsNRBJZuasb7NbmFnAG6A6gVGeDkvS+vGRI6Dadk1GnIfjodp2lAfCKLIzZ2nCLOADUJ28KHeCJWn9+AiH9XJ4otp+LUacB5YGMifliRxQkJ35Z6GZA2s3mU3m22BJWj++LjWXBiLPQ2Zp4DEYSWbm7A7m0sAcOGWaOnFRngZL0vrxdeFs8WofajDyPJwI1T5EGTkNYXbmb4FmBh+C6qRFyGnnOC68JK0fXxcOwXwSqn3JNPo8cECB2o8oL4NRZGfOWbqMgFOlfRuqkxYhx4OXpPXjU1wD1b5kmnEeboRqXyLkzS5y1v7MzLn0DFenNVOw+ZJZ/D8JlqT141McBtW+ZJpxHk6Aal+ijJy1PztzlwYEl0N1siLkFHFsvpWk9eNTbAU5uYbapwyzzgPH37McofYpwsi5BrIzd6+BKbgO+X9CdbIivAmWpPXjm0dNcw1knocboNqnCJ+CW8MoMjPnSLHIY62e7Kfo7OxdktaPbx6HQ7VPGWaeh2Og2qcomUMU2Zm7NNDho1CdpAjZP6700+PWj28efMBQQ2kg+zywNPAsVPsWYeSCftmZfwYawKnRMpvMt8KStH58fdgE1b5FWsN5yJy1n6WByCfpmZmzNMDa74aHU6OpExQlp4YrSevH14ca5hqo4TwcDdW+RXkojCI787fDDU/mU3ROCVe6qdj68fWBDxgyp997EdZwHviXY+bUfPxrMgpmnlka+Bu44eHUaOrkRBjRVGz9+PqSuRQIb661kLnWP2927LkSxZVQ7UeEnIaQde4NS3aTmQvJlaT141sWtY8R1kT2rP0c/x8FyxBqH6Ks7fo3xhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYMxd7wF//3n03S+vEZY4wxxhhjjCnAZpv9DxSoNHaju5FtAAAAAElFTkSuQmCC" alt="Logo" class="logo">
  </div>

  <div class="kra-outer">
    <div class="kra-container" id="kra-container">
      <div class="kra-header">
        <div class="kra-title">KRA IMPORT'SS</div>
      </div>

      <!--
        Pour modifier ce texte, édite directement index.html dans GitHub.
        (L'édition via UI a été supprimée volontairement.)
      -->
      <div id="kra-msg">Avis de recherche : Vladimir Humbert<br>Récompense : les usin'ss</div>

      <div id="kra-meta">
        <div id="kra-last">Dernière mise à jour: —</div>
        <div id="kra-author"></div>
      </div>
    </div>
  </div>

  <!-- CONTROLS : title + compact responsive controls -->
  <div class="controls" role="region" aria-label="Contrôles calendrier">
    <div class="title-row">
      <h2 id="month-title">Septembre 2025</h2>
    </div>

    <div class="calendar-controls" aria-hidden="false">
      <div class="month-selector">
        <div class="select-wrap" style="margin:0;">
          <select id="month-select" aria-label="Choisir le mois">
            <option value="9" selected>Septembre</option>
            <option value="10">Octobre</option>
            <option value="11">Novembre</option>
          </select>
        </div>
      </div>

      <div class="days-selector" style="align-items:center;">
        <label for="cols-select" style="font-size:0.95rem; color:#ddd; margin-right:6px;">Jours/ligne</label>
        <div class="select-wrap">
          <select id="cols-select" aria-label="Nombre de jours par ligne">
            <option value="3" selected>3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="calendar-wrap">
    <div class="calendar-container" id="calendar"></div>
  </div>

  <div class="overlay" id="overlay"></div>

  <div class="footer">224 Corp.</div>

  <script>
    /* ---------- GLITCH ---------- */
    const logoEl = document.querySelector('.logo');
    function triggerGlitch(){
      if(!logoEl) return;
      logoEl.classList.add('glitch');
      setTimeout(()=>{ logoEl.classList.remove('glitch'); setTimeout(triggerGlitch, 200 + Math.random() * 1300); }, 120);
    }
    triggerGlitch();

    /* ---------- PARTICLES (DPR-aware) ---------- */
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext && canvas.getContext('2d');
    let particles = [];
    let mouseX = null, mouseY = null;
    function resizeCanvas(){
      if(!canvas || !ctx) return;
      const dpr = window.devicePixelRatio || 1;
      canvas.width = Math.floor(window.innerWidth * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width = window.innerWidth + 'px';
      canvas.style.height = window.innerHeight + 'px';
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    window.addEventListener('mousemove', e=>{ mouseX = e.clientX; mouseY = e.clientY; });

    function initParticles(){
      particles = [];
      for(let i=0;i<90;i++){
        particles.push({ x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight, size: Math.random()*1.8+0.6, speed: Math.random()*0.35+0.12, opacity: Math.random()*0.5+0.3 });
      }
    }
    function drawParticles(){
      if(!ctx) return;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach(p=>{
        ctx.beginPath();
        ctx.shadowBlur = 15; ctx.shadowColor = 'rgba(255,0,255,0.8)';
        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
        ctx.fillStyle = `rgba(255, 100, 255, ${p.opacity})`;
        ctx.fill();
        p.y -= p.speed;
        if(mouseX !== null && mouseY !== null){
          let dx = mouseX - p.x, dy = mouseY - p.y;
          let dist = Math.sqrt(dx*dx + dy*dy);
          if(dist < 100){ p.x -= dx * 0.002; p.y -= dy * 0.002; }
        }
        if(p.y < -p.size){ p.y = window.innerHeight + p.size; p.x = Math.random()*window.innerWidth; }
      });
      requestAnimationFrame(drawParticles);
    }
    initParticles();
    drawParticles();

    /* ---------- CALENDAR & DATA (unchanged) ---------- */
    const days = ["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];
    const monthSelect = document.getElementById('month-select');
    const colsSelect = document.getElementById('cols-select');
    const calendarContainer = document.getElementById('calendar');
    const monthTitle = document.getElementById('month-title');
    const currentYear = 2025;
    let daysPerRow = parseInt(colsSelect.value,10) || 3;

    const eventsData = {
      /* --- SEPTEMBRE --- */
      "2025-09-01":[{time:"18:45",title:"Remise des num'ss",color:"blue"},{time:"19:15",title:"Flam'ss",color:"blue"}],
      "2025-09-02":[{time:"12:40",title:"Remise des Zagrises",color:"blue"},{time:"20:00",title:"Prise en m'ss",color:"red"}],
      "2025-09-03":[{time:"20:00",title:"Nuit du Carn'ss",color:"blue"}],
      "2025-09-04":[{time:"20:00",title:"Bottage d'oc'ss",color:"blue"}],
      "2025-09-05":[{time:"20:00",title:"Fin'ss Archis",color:"blue"}],
      "2025-09-06":[{time:"",title:"Wix P3",color:"pink"}],
      "2025-09-07":[{time:"",title:"Wix P3",color:"pink"}],
      "2025-09-08":[{time:"20:00",title:"Nuit des Sacqués",color:"blue"}],
      "2025-09-09":[{time:"Aprem",title:"Essayage Zag",color:"blue"},{time:"20:00",title:"Chalon'ss/Boquette",color:"blue"}],
      "2025-09-10":[{time:"20:00",title:"Mort des Trad'ss",color:"blue"}],
      "2025-09-11":[{time:"Aprem",title:"Visiste Learning Center",color:"blue"},{time:"20:00",title:"Manip Banquet",color:"blue"}],
      "2025-09-12":[{time:"20:00",title:"Prez UAI",color:"blue"}],
      "2025-09-15":[{time:"20:00",title:"KIN/Clun'ss",color:"blue"}],
      "2025-09-16":[{time:"",title:"UAI",color:"yellow",textBlack:true}],
      "2025-09-17":[{time:"Aprem",title:"Solidarité Béthune",color:"blue"},{time:"20:00",title:"Hypo-bucque",color:"blue"}],
      "2025-09-18":[{time:"20:00",title:"Prez Foy'ss",color:"blue"}],
      "2025-09-19":[{time:"20:00",title:"Déreunssage/Perm'ss/Porte-perm'ss",color:"blue"}],
      "2025-09-22":[{time:"20:00",title:"Birse/P3",color:"blue"}],
      "2025-09-23":[{time:"",title:"UAI",color:"yellow",textBlack:true}],
      "2025-09-24":[{time:"20:00",title:"Thuyssage Chop'ss",color:"blue"}],
      "2025-09-25":[{time:"20:00",title:"Manip Gorg'ss",color:"blue"}],
      "2025-09-26":[{time:"20:00",title:"Lettre à soi-même",color:"blue"}],
      "2025-09-27":[{time:"Soir",title:"Fin'ss Archis Chop'ss",color:"blue"}],
      "2025-09-28":[{time:"Aprem",title:"Chop'ss",color:"red"}],
      "2025-09-29":[{time:"20:00",title:"Manip AMJE",color:"blue"}],
      "2025-09-30":[{time:"",title:"UAI",color:"yellow",textBlack:true}],
      /* --- OCTOBRE / NOVEMBRE --- (les mêmes données que précédemment) */
      "2025-10-01":[{time:"20:00",title:"Hypo-bucque 2",color:"blue"}],
      "2025-10-02":[{time:"06:00",title:"Hypo-moütardes",color:"blue"},{time:"20:00",title:"Bordel'ss/Siber'ss/Knack",color:"blue"}],
      "2025-10-03":[{time:"20:00",title:"Nuit des justiciers",color:"blue"}],
      "2025-10-06":[{time:"",title:"Mise HU",color:"red"}],
      "2025-10-09":[{time:"20:00",title:"Nuit de la glacière",color:"blue"}],
      "2025-10-13":[{time:"",title:"Remise en usin'ss",color:"red"}],
      "2025-10-14":[{time:"20:00",title:"14 oct./125 ans",color:"blue"}],
      "2025-10-15":[{time:"20:00",title:"Lettre aux Archis",color:"blue"}],
      "2025-10-16":[{time:"20:00",title:"Nuit des Atel'ss",color:"blue"}],
      "2025-10-17":[{time:"20:00",title:"Nuit de la Rez/CC Trad'ss",color:"blue"}],
      "2025-10-20":[{time:"20:00",title:"Monôme de Birse/Tap'ss Foy'ss",color:"blue"}],
      "2025-10-21":[{time:"",title:"UAI",color:"yellow",textBlack:true}],
      "2025-10-22":[{time:"20:00",title:"Nuit des justiciers 2",color:"blue"}],
      "2025-10-23":[{time:"20:00",title:"Manip Bonsergent",color:"blue"}],
      "2025-10-24":[{time:"20:00",title:"Nuit des Sout'ss",color:"red"}],
      "2025-10-25":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-26":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-27":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-28":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-29":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-30":[{time:"",title:"DKL",color:"grey"}],
      "2025-10-31":[{time:"",title:"DKL",color:"grey"}],
      "2025-11-01":[{time:"",title:"DKL",color:"grey"}],
      "2025-11-02":[{time:"",title:"DKL",color:"grey"}],
      "2025-11-03":[{time:"20:00",title:"Prez Fignoss",color:"blue"}],
      "2025-11-04":[{time:"",title:"UAI",color:"yellow",textBlack:true}],
      "2025-11-05":[{time:"20:00",title:"Pal'ss SE/Prom'ss",color:"blue"}],
      "2025-11-06":[{time:"20:00",title:"Comit'ss Paillards",color:"blue"}],
      "2025-11-07":[{time:"20:00",title:"Pal'ss Micro-Par'ss",color:"blue"}],
      "2025-11-08":[{time:"",title:"Wix Micro-Par'ss",color:"pink"}],
      "2025-11-09":[{time:"",title:"Wix Micro-Par'ss",color:"pink"}],
      "2025-11-10":[{time:"20:00",title:"Double Pal'ss/Amphi Ayat'ss/Nuit de l'Ours",color:"blue"}],
      "2025-11-11":[{time:"06:00",title:"Pal'ss Taper la phase",color:"blue"},{time:"12:00",title:"Pal'ss",color:"blue"},{time:"14:00",title:"11 Nov.",color:"blue"},{time:"20:00",title:"Pal'ss dans les Sout'ss/Brûlage de Carn'ss",color:"blue"}],
      "2025-11-12":[{time:"06:00",title:"Pal'ss rébellion des washs",color:"blue"},{time:"20:00",title:"St El'ss",color:"red"}],
      "2025-11-13":[{time:"Jusqu'au soir",title:"St El'ss",color:"red"},{time:"20:00",title:"Dernière chouille de prom'ss",color:"blue"}],
      "2025-11-14":[{time:"20:00",title:"Fin'ss de remise de fam'ss/Soirée de zocquage",color:"blue"}],
      "2025-11-15":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-16":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-17":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-18":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-19":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-20":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-21":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-22":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-23":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-24":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-25":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-26":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-27":[{time:"",title:"Gnasse Fignoss",color:"orange"}],
      "2025-11-28":[{time:"Jusqu'au soir",title:"Gnasse Fignoss",color:"orange"},{time:"20:00",title:"Bapt'ss",color:"red"}],
      "2025-11-29":[{time:"",title:"Bapt'ss V2/Fignoss",color:"green"}],
      "2025-11-30":[]
    };

    function generateCalendar(month, cols){
      calendarContainer.innerHTML = '';
      monthTitle.textContent = `${monthSelect.options[monthSelect.selectedIndex].text} ${currentYear}`;
      const daysInMonth = new Date(currentYear, month, 0).getDate();
      let dayCounter = 1;
      while(dayCounter <= daysInMonth){
        const weekDiv = document.createElement('div'); weekDiv.className = 'week';
        weekDiv.style.setProperty('--cols', cols);
        const rowDayNumbers = [];
        for(let i=0;i<cols;i++){
          if(dayCounter <= daysInMonth){ rowDayNumbers.push(dayCounter); dayCounter++; } else { rowDayNumbers.push(null); }
        }
        // headers
        for(let i=0;i<cols;i++){
          const header = document.createElement('div'); header.className = 'header';
          const d = rowDayNumbers[i];
          if(d){
            const weekday = new Date(currentYear, month-1, d).getDay();
            const dayName = days[(weekday + 6) % 7];
            header.textContent = `${dayName} ${String(d).padStart(2,'0')}`;
          } else { header.textContent = ''; header.style.visibility = 'hidden'; }
          weekDiv.appendChild(header);
        }
        // days
        for(let i=0;i<cols;i++){
          const dayBox = document.createElement('div'); dayBox.className = 'day'; dayBox.setAttribute('onclick','zoom(this)');
          const d = rowDayNumbers[i];
          if(d && d>0){
            const dateKey = `${currentYear}-${String(month).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
            const events = eventsData[dateKey];
            if(events && events.length){
              events.forEach(evData=>{
                if(!evData || !evData.title) return;
                const ev = document.createElement('div'); ev.className = 'event';
                const colorClass = evData.color ? evData.color : 'blue';
                ev.classList.add(colorClass);
                if(evData.textBlack) ev.classList.add('text-black');
                const timeDiv = document.createElement('div'); timeDiv.className = 'time'; timeDiv.innerText = evData.time ? evData.time : '';
                const titleDiv = document.createElement('div'); titleDiv.className = 'title'; titleDiv.innerText = evData.title;
                ev.appendChild(timeDiv); ev.appendChild(titleDiv);
                if(evData.description){ const desc = document.createElement('div'); desc.className='description'; desc.innerText = evData.description; ev.appendChild(desc); }
                dayBox.appendChild(ev);
              });
            }
          }
          weekDiv.appendChild(dayBox);
        }
        calendarContainer.appendChild(weekDiv);
      }
    }

    monthSelect.addEventListener('change', ()=> generateCalendar(parseInt(monthSelect.value,10), daysPerRow));
    colsSelect.addEventListener('change', ()=> { const v = parseInt(colsSelect.value,10); if(!isNaN(v) && v>=3 && v<=7){ daysPerRow = v; generateCalendar(parseInt(monthSelect.value,10), daysPerRow); }});
    generateCalendar(parseInt(monthSelect.value,10), daysPerRow);

    /* ---------- ZOOM modal (freeze page scroll while open) ---------- */
    const overlay = document.getElementById('overlay');
    let zoomState = { open:false, origEl:null, scrollY:0, outer:null, closeBtn:null };

    function zoom(el){
      if(zoomState.open) return;
      zoomState.open = true;
      zoomState.origEl = el;
      // save scroll pos & freeze body by fixing it
      zoomState.scrollY = window.scrollY || window.pageYOffset || 0;
      document.body.classList.add('modal-open');
      document.body.style.top = `-${zoomState.scrollY}px`;

      overlay.style.display = 'block';

      const rect = el.getBoundingClientRect();
      const outer = document.createElement('div'); outer.className = 'zoom-outer';
      const inner = document.createElement('div'); inner.className = 'zoom-inner';
      const clone = el.cloneNode(true);
      clone.style.pointerEvents = 'auto';
      clone.style.background = 'transparent';
      clone.style.width = rect.width + 'px';
      clone.style.boxSizing = 'border-box';
      inner.appendChild(clone);

      inner.style.left = rect.left + 'px';
      inner.style.top = rect.top + 'px';
      inner.style.width = rect.width + 'px';
      inner.style.height = rect.height + 'px';
      inner.style.transform = 'translate(0,0) scale(1)';
      inner.style.zIndex = 3100;
      inner.style.borderRadius = '14px';
      inner.style.overflow = 'hidden';

      const closeBtn = document.createElement('button');
      closeBtn.className = 'zoom-fixed-close';
      closeBtn.innerText = 'Fermer';
      closeBtn.onclick = ()=> closeZoom();

      outer.appendChild(inner);
      document.body.appendChild(outer);
      document.body.appendChild(closeBtn);

      // target zoom (slightly reduced)
      const viewportW = window.innerWidth;
      const viewportH = window.innerHeight;
      const targetMaxW = Math.min(viewportW * 0.86, 900);
      const targetMaxH = Math.min(viewportH * 0.86, viewportH - 80);
      const scaleX = targetMaxW / rect.width;
      const scaleY = targetMaxH / rect.height;
      const scale = Math.min(scaleX, scaleY);

      const rectCenterX = rect.left + rect.width / 2;
      const rectCenterY = rect.top + rect.height / 2;
      const viewportCenterX = viewportW / 2;
      const viewportCenterY = viewportH / 2;
      const translateX = viewportCenterX - rectCenterX;
      const translateY = viewportCenterY - rectCenterY;

      zoomState.outer = outer;
      zoomState.closeBtn = closeBtn;

      requestAnimationFrame(()=> {
        inner.style.transition = 'transform 420ms cubic-bezier(.22,.9,.32,1), left .42s, top .42s, width .42s, height .42s';
        inner.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
      });
    }

    function closeZoom(){
      if(!zoomState.open) return;
      overlay.style.display = 'none';
      const outer = zoomState.outer;
      const inner = outer ? outer.querySelector('.zoom-inner') : null;
      if(zoomState.origEl && inner){
        const rect = zoomState.origEl.getBoundingClientRect();
        inner.style.transition = 'transform 320ms ease-in, left .32s, top .32s, width .32s, height .32s';
        inner.style.left = rect.left + 'px';
        inner.style.top = rect.top + 'px';
        inner.style.width = rect.width + 'px';
        inner.style.height = rect.height + 'px';
        inner.style.transform = 'translate(0,0) scale(1)';
        setTimeout(()=> {
          if(zoomState.outer && zoomState.outer.parentNode) zoomState.outer.parentNode.removeChild(zoomState.outer);
          if(zoomState.closeBtn && zoomState.closeBtn.parentNode) zoomState.closeBtn.parentNode.removeChild(zoomState.closeBtn);
          // restore page scroll
          document.body.classList.remove('modal-open');
          document.body.style.top = '';
          window.scrollTo(0, zoomState.scrollY || 0);
          zoomState = { open:false, origEl:null, scrollY:0, outer:null, closeBtn:null };
        }, 360);
      } else {
        if(zoomState.outer && zoomState.outer.parentNode) zoomState.outer.parentNode.removeChild(zoomState.outer);
        if(zoomState.closeBtn && zoomState.closeBtn.parentNode) zoomState.closeBtn.parentNode.removeChild(zoomState.closeBtn);
        document.body.classList.remove('modal-open');
        document.body.style.top = '';
        window.scrollTo(0, zoomState.scrollY || 0);
        zoomState = { open:false, origEl:null, scrollY:0, outer:null, closeBtn:null };
      }
    }

    // overlay click closes zoom
    document.getElementById('overlay').addEventListener('click', ()=>{ if(zoomState.open) closeZoom(); });

    // defensive
    document.documentElement.style.overflowX = 'hidden';
    document.body.style.overflowX = 'hidden';

  </script>
</body>
</html>











